<div class="bulk-upload-page">

  <!-- Hero -->
  <div class="hero">
    <h1>FDP Transactions – Bulk Upload</h1>
    <p>Upload FDP staff transaction details using Excel / CSV file</p>
  </div>

  <!-- Upload Card -->
  <div class="modern-card">

    <div class="card-header">
      <h2>New FDP Transaction Upload</h2>
      <p class="subtitle">Enter details and upload Excel file</p>
    </div>

    <!-- Form Row -->
    <div class="form-row">

      <div class="input-group floating-label">
        <input type="text"
               [(ngModel)]="collegeName"
               id="collegeName"
               required />
        <label [class.active]="collegeName">College Name</label>
      </div>

      <div class="input-group floating-label">
        <input type="text"
               [(ngModel)]="collegeShortCode"
               id="collegeShortCode"
               required />
        <label [class.active]="collegeShortCode">College Short Code</label>
      </div>

      <div class="input-group floating-label">
        <input type="date"
               [(ngModel)]="fromDate"
               id="fromDate" />
        <label [class.active]="fromDate">From Date</label>
      </div>

      <div class="input-group floating-label">
        <input type="date"
               [(ngModel)]="toDate"
               id="toDate" />
        <label [class.active]="toDate">To Date</label>
      </div>

    </div>

    <!-- Dropzone -->
    <div class="modern-dropzone"
         (click)="fileInput.click()">

      <div class="icon-circle">
        <i class="fa-solid fa-cloud-arrow-up fa-2x"></i>
      </div>

      <p class="drop-text">Drag & drop your Excel file here</p>
      <p class="or">or</p>
      <p class="browse-text">Click to Browse File</p>

      <input
        #fileInput
        type="file"
        accept=".xlsx,.xls,.csv"
        (change)="onFileSelected($event)"
        hidden
      />
    </div>

    <div class="file-status" *ngIf="fileName">
      Selected File: <strong>{{ fileName }}</strong>
    </div>

    <div class="action-bar">

      <button class="btn btn-outline"
              (click)="downloadTemplate()">
        <i class="fa-solid fa-file-arrow-down"></i>
        Download Template
      </button>

      <button class="btn btn-primary"
              [disabled]="!selectedFile"
              (click)="uploadFile()">
        <i class="fa-solid fa-upload"></i>
        Upload Excel
      </button>

    </div>

  </div>

  <!-- Uploaded Table -->
  <div class="modern-section" *ngIf="rows.length">

    <h3>Uploaded FDP Transactions</h3>

    <table class="modern-table">
      <thead>
        <tr>
          <th *ngFor="let h of tableHeaders">
            {{ h | titlecase }}
          </th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let row of rows">
          <td *ngFor="let h of tableHeaders">
            {{ row[h] || '—' }}
          </td>
        </tr>
      </tbody>
    </table>

  </div>

  <!-- Preview Modal -->
<!-- Preview Modal -->
<div class="modal-backdrop" *ngIf="showPreview">

  <div class="modal fullscreen">

    <!-- Header -->
    <div class="modal-header">
      <h2>FDP Transactions – Preview</h2>
    </div>

    <!-- Info -->
    <div class="modal-info">
      Total Records: <strong>{{ uploadedData.length }}</strong>
    </div>

    <!-- Scrollable Table -->
    <div class="preview-table-wrapper">
      <table class="preview-table">

        <thead>
          <tr>
            <th *ngFor="let h of tableHeaders">
              {{ h | titlecase }}
            </th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let row of uploadedData">
            <td *ngFor="let h of tableHeaders">
              {{ row[h] || '—' }}
            </td>
          </tr>
        </tbody>

      </table>
    </div>

    <!-- Footer -->
    <div class="modal-footer">
      <button class="btn btn-outline"
              (click)="showPreview = false">
        Cancel
      </button>

      <button class="btn btn-primary"
              (click)="confirmUpload()">
        Confirm Upload
      </button>
    </div>

  </div>

</div>


</div>
